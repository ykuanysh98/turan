import{_ as w}from"./EMJ3jXYp.js";import{d as x,i as _,b as y,j as z,k as B,o as u,c as m,a as A,t as b,e as r,g as S,l as I,m as h,n as N,p as D,q as U,u as M,s as O,w as c,f as d,_ as j,h as q}from"./DVShB6SZ.js";import{_ as E}from"./OsUdAg49.js";import{u as F,_ as G}from"./BDe4hmf0.js";import{u as L}from"./CeSNSqsz.js";import"./Dfu3rjJP.js";import"./DUd0sDly.js";import"./CxKp_Gs2.js";import"./BUzgZXDy.js";const P=["for"],R={key:0,class:"base-input__label"},H={key:1,class:"base-input__error"},J=x({__name:"index",props:{id:{type:String,default:""},modelValue:{type:[String,Number],default:""},type:{type:String,default:"text"},label:{type:String,default:""},variant:{type:String,default:"primary"},size:{type:String,default:"md"},placeholder:{type:String,default:""},prependIcon:{type:String,default:""},maska:{type:String,default:""},text:{type:String,default:""},error:{type:String,default:""}},emits:["update:modelValue"],setup(a,{emit:t}){const e=a,o=_(""),l=t,n=y(()=>{let s=["base-input"];return e.variant&&s.push(`base-input__variant--${e.variant}`),e.size&&s.push(`base-input__size--${e.size}`),s});return z(o,(s,i)=>{l("update:modelValue",s)}),(s,i)=>{const f=B("v-otp-input");return u(),m("div",{class:N(n.value)},[A("label",{for:a.id,class:"base-input__label"},b(a.label),9,P),r(f,{modelValue:o.value,"onUpdate:modelValue":i[0]||(i[0]=g=>o.value=g),class:"base-input__otp",length:4,placeholder:a.placeholder},null,8,["modelValue","placeholder"]),a.text?(u(),m("span",R,[S(b(a.text)+" ",1),I(s.$slots,"default",{},void 0,!0)])):h("",!0),a.error?(u(),m("span",H,b(a.error),1)):h("",!0)],2)}}}),K=D(J,[["__scopeId","data-v-92e0a9bb"]]),Q=window.setInterval;function W(a){const t=_(a);let e=null;const o=y(()=>t.value<10?`0${t.value}`:t.value),l=()=>{e||(t.value=59,e=Q(()=>{t.value>0?t.value-=1:(clearInterval(e),e=null)},1e3))},n=()=>{e&&(clearInterval(e),e=null)};return U(()=>{n()}),{remainingTime:o,startTimer:l,stopTimer:n}}const X={class:"auth-login"},Y=x({__name:"index",setup(a){const t=_(""),e=_(""),{remainingTime:o,startTimer:l}=W(59),n=F(),s=L(),i=M();O(()=>{l()});const f=function(){n.otp({phone:`${n.phone}`}),l(),e.value=""},g=async function(){var v;t.value.length<4||(await n.login({code:t.value}),(v=n.loginData)!=null&&v.success?(n.name&&s.update({first_name:n.name}),i.push("/")):n.loginData.message&&(e.value=n.loginData.message))};return(v,p)=>{const V=w,k=K,C=j,T=E;return u(),m("div",X,[r(V,{title:"Введите пин код",subtitle:"Мы отправили вам СМС с кодом из 4 цифр, на номер +7 702 473 29 49 Введите его ниже:",size:"xs"}),r(T,{size:"lg"},{bottom:c(()=>[r(C,{class:"mt-8",disabled:t.value.length<4,loading:d(n).pending,onClick:g,block:""},{default:c(()=>p[1]||(p[1]=[S(" Готово ")])),_:1},8,["disabled","loading"])]),default:c(()=>[r(k,{modelValue:t.value,"onUpdate:modelValue":p[0]||(p[0]=$=>t.value=$),label:"Пин код",text:d(o)!="00"?`Можно отправить повторно через 00:${d(o)}`:"Еще раз",placeholder:"0",error:e.value},{default:c(()=>[d(o)==="00"?(u(),m("label",{key:0,class:"auth-login__time",onClick:f},"отправить")):h("",!0)]),_:1},8,["modelValue","text","error"])]),_:1})])}}}),ue=x({__name:"otp",setup(a){return(t,e)=>{const o=Y,l=G;return u(),q(l,null,{default:c(()=>[r(o)]),_:1})}}});export{ue as default};
